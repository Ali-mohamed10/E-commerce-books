import{r as y,N as f,u as N,j as e,S as I}from"./index-BQHji7x1.js";import{C}from"./CartButton-DhxeZ-wZ.js";import{S as m}from"./AnimationSection-CljoU1C8.js";function S(){const{data:a,setData:d}=y.useContext(f),{isSignedIn:p,user:$}=N(),o=a?.flatMap((t,r)=>t.books.map((n,s)=>({book:n,bookIndex:s})).filter(({book:n})=>n.isToCart).map(({book:n,bookIndex:s})=>({title:n.title,imgCover:n.book_image,author:n.author,price:n.price,listName:t.list_name,listIndex:r,bookIndex:s,quantity:n.quantity??1})))||[],u=o.reduce((t,r)=>t+(Number(r.price)||0)*(Number(r.quantity)||1),0),h=()=>{const r=`ðŸ›’ Order Details:

${o.map(s=>`ðŸ“š ${s.title} - ${s.author} - Qty: ${s.quantity} - $${s.price}`).join(`
`)}

ðŸ’° Total: $${u}

Hello! I would like to purchase these books.`,n=`https://wa.me/+201154167974?text=${encodeURIComponent(r)}`;window.open(n,"_blank")},b=(t,r)=>{a&&d(n=>n&&n.map((s,l)=>l!==t?s:{...s,books:s.books.map((i,x)=>{if(x!==r)return i;const c=i.quantity??1;return{...i,quantity:c+1}})}))},g=(t,r)=>{a&&d(n=>n&&n.map((s,l)=>l!==t?s:{...s,books:s.books.map((i,x)=>{if(x!==r)return i;const c=i.quantity??1,j=Math.max(1,c-1);return{...i,quantity:j}})}))};return e.jsx(m,{children:e.jsxs("div",{className:"shop-cart container mx-auto px-5 rounded-2xl py-12 bg-backgrounds",children:[e.jsx("h2",{className:"text-2xl md:text-3xl mb-2 font-bold",children:"Shop Cart :"}),o.length!==0?o.map(t=>e.jsx(m,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-5 mt-5 items-center",children:[e.jsx("div",{children:e.jsx("img",{src:t.imgCover,alt:t.title,loading:"lazy",className:"h-32 w-full"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl md:text-2xl mb-1",children:t.title}),e.jsxs("span",{className:"block text-second text-base md:text-2xl mb-8",children:["price : $",t.price]}),e.jsx(C,{listIndex:t.listIndex,bookIndex:t.bookIndex})]}),e.jsxs("div",{className:"ml-auto",children:[e.jsx("button",{className:`text-white ml-2 py-0.5 px-1.5 border border-second bg-main ${t.quantity===1?"opacity-30":"cursor-pointer"}`,onClick:()=>g(t.listIndex,t.bookIndex),children:"-"}),e.jsx("span",{className:"ml-2",children:t.quantity}),e.jsx("button",{className:"text-white ml-2 py-0.5 px-1.5 border border-second bg-main cursor-pointer",onClick:()=>b(t.listIndex,t.bookIndex),children:"+"})]})]}),e.jsx("hr",{className:"mt-5"})]},`${t.listIndex}-${t.bookIndex}`)})):e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-gray-600 text-center text-xl md:text-2xl mt-5",children:"Your cart is empty"})}),o.length>0?e.jsxs("div",{className:"flex flex-wrap justify-between gap-5 mt-5",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-500 md:text-xl",children:["Total Cart Price : $",u]}),p?e.jsx("button",{onClick:h,className:"bg-green-700 px-4 py-1 rounded-xl font-bold cursor-pointer text-white hover:bg-green-800 transition-colors duration-200",children:"Proceed To Buy"}):e.jsx(I,{mode:"modal",children:e.jsx("button",{className:"bg-green-700 px-4 py-1 rounded-xl font-bold cursor-pointer text-white hover:bg-green-800 transition-colors duration-200",children:"Sign In To Buy"})})]}):""]})})}export{S as default};
